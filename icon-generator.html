<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>JubPai — Icon Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&display=swap" rel="stylesheet">
<style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
        background: #07031a;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        font-family: 'Cinzel', Georgia, serif;
        color: #c0b8e8;
        padding: 32px 16px;
        gap: 28px;
    }
    h2 {
        font-size: 15px;
        font-weight: 400;
        letter-spacing: 5px;
        opacity: 0.45;
        text-transform: uppercase;
    }
    .preview-row {
        display: flex;
        gap: 24px;
        align-items: flex-end;
    }
    .preview-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
    }
    .preview-item span {
        font-size: 11px;
        opacity: 0.35;
        letter-spacing: 1px;
        font-family: sans-serif;
    }
    canvas {
        border-radius: 18%;
        box-shadow: 0 0 32px rgba(120, 60, 240, 0.35), 0 0 8px rgba(100, 50, 200, 0.2);
        border: 1px solid rgba(150, 100, 255, 0.18);
        display: block;
    }
    .controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
    }
    button {
        padding: 10px 22px;
        background: linear-gradient(135deg, #2a0e50, #170730);
        color: #c0b0e8;
        border: 1px solid rgba(150, 90, 255, 0.32);
        border-radius: 8px;
        font-size: 13px;
        font-family: 'Cinzel', Georgia, serif;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.2s;
    }
    button:hover {
        background: linear-gradient(135deg, #440f8a, #2a0e50);
        border-color: rgba(180, 130, 255, 0.6);
        box-shadow: 0 0 14px rgba(130, 70, 240, 0.3);
    }
    .note {
        font-size: 12px;
        opacity: 0.3;
        font-family: sans-serif;
        text-align: center;
    }
</style>
</head>
<body>

<h2>JubPai &mdash; Icon Generator</h2>

<div class="preview-row">
    <div class="preview-item">
        <canvas id="prev512" width="512" height="512" style="width:210px;height:210px;"></canvas>
        <span>512 px</span>
    </div>
    <div class="preview-item">
        <canvas id="prev192" width="192" height="192" style="width:100px;height:100px;"></canvas>
        <span>192 px</span>
    </div>
    <div class="preview-item">
        <canvas id="prev48" width="48" height="48" style="width:54px;height:54px;"></canvas>
        <span>48 px</span>
    </div>
</div>

<div class="controls">
    <button onclick="dl(1024)">1024 px</button>
    <button onclick="dl(512)">512 px</button>
    <button onclick="dl(192)">192 px</button>
    <button onclick="dl(48)">48 px</button>
    <button onclick="dlAll()" style="background:linear-gradient(135deg,#3a0f70,#1e0840);border-color:rgba(180,130,255,0.45);">Download All</button>
</div>

<p class="note">Save <code>192px</code> and <code>512px</code> to <code>images/icons/</code> for PWA support.</p>

<!-- Hidden master canvas 1024×1024 -->
<canvas id="src" width="1024" height="1024" style="display:none;"></canvas>

<script>
const src = document.getElementById('src');
const ctx = src.getContext('2d');
const W = 1024, H = 1024;

// ── Seeded random (deterministic stars) ─────────────────────────────────────
let _s = 0;
const rand = () => { _s = (_s * 9301 + 49297) % 233280; return _s / 233280; };
const resetSeed = () => { _s = 55321; };

// ── Entry ────────────────────────────────────────────────────────────────────
function drawIcon() {
    resetSeed();
    ctx.clearRect(0, 0, W, H);

    drawBackground();
    drawNebula();
    drawStarField(220);
    drawOuterBorder();
    drawMoonRow(W / 2, 94);
    drawGalaxyPortal(W / 2, 374);
    drawDivider(W / 2, 622);
    drawTitle(W / 2, 772);
    drawSubtitle(W / 2, 882);
    drawSparkles();
}

// ── Helpers ──────────────────────────────────────────────────────────────────
function rrect(x, y, w, h, r) {
    ctx.beginPath();
    ctx.moveTo(x + r, y);
    ctx.lineTo(x + w - r, y); ctx.quadraticCurveTo(x + w, y, x + w, y + r);
    ctx.lineTo(x + w, y + h - r); ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
    ctx.lineTo(x + r, y + h); ctx.quadraticCurveTo(x, y + h, x, y + h - r);
    ctx.lineTo(x, y + r); ctx.quadraticCurveTo(x, y, x + r, y);
    ctx.closePath();
}

// ── Background ───────────────────────────────────────────────────────────────
function drawBackground() {
    ctx.save();
    rrect(0, 0, W, H, 185);
    ctx.clip();
    const g = ctx.createRadialGradient(W / 2, H * 0.36, 20, W / 2, H * 0.55, W * 0.88);
    g.addColorStop(0,    '#27095e');
    g.addColorStop(0.22, '#1a0640');
    g.addColorStop(0.55, '#0e0428');
    g.addColorStop(1,    '#060116');
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, W, H);
    ctx.restore();
}

// ── Nebula atmosphere ────────────────────────────────────────────────────────
function drawNebula() {
    ctx.save();
    rrect(0, 0, W, H, 185);
    ctx.clip();
    const clouds = [
        { x: W * 0.44, y: H * 0.34, r: 380, c: 'rgba(140,45,240,0.20)' },
        { x: W * 0.64, y: H * 0.26, r: 270, c: 'rgba(25,165,235,0.14)' },
        { x: W * 0.28, y: H * 0.68, r: 300, c: 'rgba(210,55,185,0.08)' },
        { x: W * 0.7,  y: H * 0.62, r: 260, c: 'rgba(80,100,255,0.07)' },
    ];
    clouds.forEach(({ x, y, r, c }) => {
        const g = ctx.createRadialGradient(x, y, 0, x, y, r);
        g.addColorStop(0, c);
        g.addColorStop(1, 'transparent');
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, W, H);
    });
    ctx.restore();
}

// ── Star field ───────────────────────────────────────────────────────────────
function drawStarField(n) {
    ctx.save();
    rrect(0, 0, W, H, 185);
    ctx.clip();

    for (let i = 0; i < n; i++) {
        const x = rand() * W, y = rand() * H;
        const r = rand() * 1.7 + 0.3;
        const a = rand() * 0.5 + 0.1;
        const t = rand();
        ctx.globalAlpha = a;
        ctx.fillStyle = t < 0.4 ? '#ffffff' : t < 0.65 ? '#d0c4ff' : t < 0.85 ? '#aaddff' : '#ffd0ff';
        ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI * 2); ctx.fill();
    }

    // Bright glow stars
    for (let i = 0; i < 18; i++) {
        const x = rand() * W, y = rand() * H;
        const r = rand() * 2 + 2.5;
        ctx.globalAlpha = 0.8;
        ctx.fillStyle = '#ffffff';
        ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI * 2); ctx.fill();
        ctx.globalAlpha = 0.22;
        const gl = ctx.createRadialGradient(x, y, 0, x, y, r * 4.5);
        gl.addColorStop(0, '#ddd0ff'); gl.addColorStop(1, 'transparent');
        ctx.fillStyle = gl;
        ctx.beginPath(); ctx.arc(x, y, r * 4.5, 0, Math.PI * 2); ctx.fill();
    }
    ctx.restore();
}

// ── Outer decorative border ──────────────────────────────────────────────────
function drawOuterBorder() {
    ctx.save();
    const grd = ctx.createLinearGradient(0, 0, W, H);
    grd.addColorStop(0,   'rgba(190,120,255,0.28)');
    grd.addColorStop(0.5, 'rgba(70,200,255,0.22)');
    grd.addColorStop(1,   'rgba(210,80,255,0.28)');
    ctx.strokeStyle = grd;
    ctx.lineWidth = 4;
    rrect(16, 16, W - 32, H - 32, 174);
    ctx.stroke();

    ctx.strokeStyle = 'rgba(130,80,220,0.07)';
    ctx.lineWidth = 1.5;
    rrect(34, 34, W - 68, H - 68, 160);
    ctx.stroke();
    ctx.restore();
}

// ── Moon phase row ───────────────────────────────────────────────────────────
function drawMoonRow(cx, cy) {
    ctx.save();
    const sp = 60;
    // crescent · half · full · half · crescent
    const moons = [
        { dx: -sp * 2, r: 10, a: 0.22 },
        { dx: -sp,     r: 13, a: 0.30 },
        { dx:  0,      r: 17, a: 0.48 },  // full moon
        { dx:  sp,     r: 13, a: 0.30 },
        { dx:  sp * 2, r: 10, a: 0.22 },
    ];

    moons.forEach(({ dx, r, a }, idx) => {
        const mx = cx + dx;
        ctx.globalAlpha = a;
        ctx.fillStyle = '#d0b8ff';
        ctx.beginPath(); ctx.arc(mx, cy, r, 0, Math.PI * 2); ctx.fill();

        // Full moon glow + highlight
        if (idx === 2) {
            ctx.globalAlpha = 0.22;
            const gl = ctx.createRadialGradient(mx, cy, 0, mx, cy, r * 2.8);
            gl.addColorStop(0, 'rgba(200,165,255,0.55)');
            gl.addColorStop(1, 'transparent');
            ctx.fillStyle = gl;
            ctx.beginPath(); ctx.arc(mx, cy, r * 2.8, 0, Math.PI * 2); ctx.fill();
            ctx.globalAlpha = 0.25;
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.beginPath(); ctx.arc(mx - 4, cy - 5, 5, 0, Math.PI * 2); ctx.fill();
        }
    });

    // Thin connecting line
    ctx.globalAlpha = 0.07;
    ctx.strokeStyle = '#a090ff';
    ctx.lineWidth = 0.8;
    ctx.beginPath();
    ctx.moveTo(cx - sp * 2.6, cy); ctx.lineTo(cx + sp * 2.6, cy);
    ctx.stroke();
    ctx.restore();
}

// ── Galaxy portal ────────────────────────────────────────────────────────────
function drawGalaxyPortal(cx, cy) {
    const R = 192;

    // 1 · Atmospheric glow
    ctx.save();
    const atmo = ctx.createRadialGradient(cx, cy, R * 0.6, cx, cy, R * 2.3);
    atmo.addColorStop(0,   'rgba(110,45,230,0.22)');
    atmo.addColorStop(0.45,'rgba(75,25,165,0.09)');
    atmo.addColorStop(1,   'transparent');
    ctx.fillStyle = atmo;
    ctx.beginPath(); ctx.arc(cx, cy, R * 2.3, 0, Math.PI * 2); ctx.fill();
    ctx.restore();

    // 2 · Orbit rings with dots
    ctx.save();
    [R + 14, R + 28, R + 44].forEach((or, i) => {
        const alpha = 0.13 - i * 0.03;
        ctx.strokeStyle = `rgba(155,105,255,${alpha})`;
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.arc(cx, cy, or, 0, Math.PI * 2); ctx.stroke();

        const dc = [18, 14, 9][i];
        for (let j = 0; j < dc; j++) {
            const a = (j / dc) * Math.PI * 2 + i * 0.5;
            ctx.fillStyle = `rgba(175,135,255,${alpha * 1.6})`;
            ctx.beginPath();
            ctx.arc(cx + Math.cos(a) * or, cy + Math.sin(a) * or, 2, 0, Math.PI * 2);
            ctx.fill();
        }
    });
    ctx.restore();

    // 3 · Clipped galaxy interior
    ctx.save();
    ctx.beginPath(); ctx.arc(cx, cy, R, 0, Math.PI * 2); ctx.clip();

    // Interior bg
    const ibg = ctx.createRadialGradient(cx, cy, 0, cx, cy, R);
    ibg.addColorStop(0,    '#3d1490');
    ibg.addColorStop(0.22, '#2b0e6a');
    ibg.addColorStop(0.6,  '#16083e');
    ibg.addColorStop(1,    '#090224');
    ctx.fillStyle = ibg; ctx.fillRect(cx - R, cy - R, R * 2, R * 2);

    // Spiral arms (3)
    for (let arm = 0; arm < 3; arm++) {
        const baseA = (arm / 3) * Math.PI * 2;
        const palettes = [
            [160, 75, 255],
            [35,  160, 255],
            [225, 65, 255],
        ];
        const [pr, pg, pb] = palettes[arm];
        for (let t = 0.04; t < 1; t += 0.022) {
            const a    = baseA + t * Math.PI * 2.5;
            const d    = t * R * 0.9;
            const px   = cx + Math.cos(a) * d;
            const py   = cy + Math.sin(a) * d;
            const blob = (1 - t) * 30 + 5;
            const alpha = (1 - t) * 0.24 + 0.03;
            ctx.fillStyle = `rgba(${pr},${pg},${pb},${alpha})`;
            ctx.beginPath(); ctx.arc(px, py, blob, 0, Math.PI * 2); ctx.fill();
        }
    }

    // Dust clouds
    [[cx+52, cy-42, 'rgba(90,200,255,0.12)'], [cx-55, cy+35, 'rgba(240,75,205,0.10)']].forEach(([x, y, c]) => {
        const dc = ctx.createRadialGradient(x, y, 0, x, y, 100);
        dc.addColorStop(0, c); dc.addColorStop(1, 'transparent');
        ctx.fillStyle = dc; ctx.fillRect(cx - R, cy - R, R * 2, R * 2);
    });

    // Stars inside portal
    for (let i = 0; i < 75; i++) {
        const a = rand() * Math.PI * 2, d = rand() * R * 0.95;
        const px = cx + Math.cos(a) * d, py = cy + Math.sin(a) * d;
        ctx.globalAlpha = rand() * 0.55 + 0.12;
        ctx.fillStyle = rand() < 0.7 ? '#ffffff' : '#c8e8ff';
        ctx.beginPath(); ctx.arc(px, py, rand() * 1.7 + 0.3, 0, Math.PI * 2); ctx.fill();
    }

    // Bright core
    ctx.globalAlpha = 1;
    const core = ctx.createRadialGradient(cx, cy, 0, cx, cy, 95);
    core.addColorStop(0,    'rgba(255,252,235,0.92)');
    core.addColorStop(0.18, 'rgba(235,195,255,0.58)');
    core.addColorStop(0.5,  'rgba(160,100,255,0.22)');
    core.addColorStop(1,    'transparent');
    ctx.fillStyle = core; ctx.fillRect(cx - R, cy - R, R * 2, R * 2);

    ctx.restore(); // end clip

    // 4 · Glowing border ring
    ctx.save();
    ctx.shadowColor = 'rgba(165,100,255,0.75)';
    ctx.shadowBlur = 28;
    const rg = ctx.createLinearGradient(cx - R, cy - R, cx + R, cy + R);
    rg.addColorStop(0,   'rgba(205,165,255,0.88)');
    rg.addColorStop(0.5, 'rgba(75,215,255,0.72)');
    rg.addColorStop(1,   'rgba(225,120,255,0.88)');
    ctx.strokeStyle = rg;
    ctx.lineWidth = 3.5;
    ctx.beginPath(); ctx.arc(cx, cy, R, 0, Math.PI * 2); ctx.stroke();
    ctx.restore();

    // 5 · Center starburst
    ctx.save();
    const cg = ctx.createRadialGradient(cx, cy, 0, cx, cy, 38);
    cg.addColorStop(0,   'rgba(255,255,255,0.96)');
    cg.addColorStop(0.28,'rgba(240,215,255,0.62)');
    cg.addColorStop(1,   'transparent');
    ctx.fillStyle = cg; ctx.beginPath(); ctx.arc(cx, cy, 38, 0, Math.PI * 2); ctx.fill();

    // 4-pointed star shape
    const sl = 24, sw = 3.8;
    ctx.fillStyle = 'rgba(255,255,255,0.94)';
    ctx.beginPath();
    ctx.moveTo(cx, cy - sl);
    ctx.bezierCurveTo(cx + sw, cy - sw, cx + sw, cy - sw, cx + sl, cy);
    ctx.bezierCurveTo(cx + sw, cy + sw, cx + sw, cy + sw, cx, cy + sl);
    ctx.bezierCurveTo(cx - sw, cy + sw, cx - sw, cy + sw, cx - sl, cy);
    ctx.bezierCurveTo(cx - sw, cy - sw, cx - sw, cy - sw, cx, cy - sl);
    ctx.closePath(); ctx.fill();
    ctx.restore();
}

// ── Ornamental divider ───────────────────────────────────────────────────────
function drawDivider(cx, cy) {
    ctx.save();
    const lw = 265;

    [[cx - lw, cx - 22, true], [cx + 22, cx + lw, false]].forEach(([x1, x2, fadeIn]) => {
        const g = ctx.createLinearGradient(x1, cy, x2, cy);
        g.addColorStop(fadeIn ? 0 : 1, 'transparent');
        g.addColorStop(fadeIn ? 1 : 0, 'rgba(165,125,255,0.42)');
        ctx.strokeStyle = g; ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(x1, cy); ctx.lineTo(x2, cy); ctx.stroke();
    });

    // Center diamond
    const d = 6.5;
    ctx.fillStyle = 'rgba(185,148,255,0.58)';
    ctx.beginPath();
    ctx.moveTo(cx, cy - d); ctx.lineTo(cx + d, cy);
    ctx.lineTo(cx, cy + d); ctx.lineTo(cx - d, cy);
    ctx.closePath(); ctx.fill();

    // Side dots
    [-20, 20].forEach(dx => {
        ctx.fillStyle = 'rgba(160,120,255,0.30)';
        ctx.beginPath(); ctx.arc(cx + dx, cy, 2.6, 0, Math.PI * 2); ctx.fill();
    });
    ctx.restore();
}

// ── "JubPai" title ───────────────────────────────────────────────────────────
function drawTitle(cx, cy) {
    ctx.save();
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.font = '900 154px "Cinzel", "Times New Roman", serif';

    // Glow layer
    ctx.shadowColor = 'rgba(155,75,255,0.9)';
    ctx.shadowBlur = 65;
    const tg = ctx.createLinearGradient(cx - 248, cy - 55, cx + 248, cy + 55);
    tg.addColorStop(0,    '#cca8ff');
    tg.addColorStop(0.28, '#ffffff');
    tg.addColorStop(0.52, '#eeddff');
    tg.addColorStop(0.74, '#badefd');
    tg.addColorStop(1,    '#cca8ff');
    ctx.fillStyle = tg;
    ctx.fillText('JubPai', cx, cy);

    // Soft secondary glow
    ctx.shadowBlur = 110;
    ctx.shadowColor = 'rgba(120,55,230,0.38)';
    ctx.globalAlpha = 0.22;
    ctx.fillStyle = '#e0ccff';
    ctx.fillText('JubPai', cx, cy);

    ctx.restore();
}

// ── Subtitle ─────────────────────────────────────────────────────────────────
function drawSubtitle(cx, cy) {
    ctx.save();
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.shadowColor = 'rgba(115,70,225,0.55)';
    ctx.shadowBlur = 14;
    ctx.fillStyle = 'rgba(192,155,255,0.58)';
    ctx.font = '400 27px "Cinzel", Georgia, serif';
    ctx.fillText('✦  T A R O T  ✦', cx, cy);
    ctx.restore();
}

// ── Sparkle crosses ──────────────────────────────────────────────────────────
function drawSparkles() {
    ctx.save();
    const sps = [
        { x: 168, y: 435, s: 17, a: 0.30, c: '#c0a2ff' },
        { x: 852, y: 400, s: 15, a: 0.27, c: '#8ed4ff' },
        { x: 112, y: 685, s: 12, a: 0.22, c: '#d0a6ff' },
        { x: 908, y: 662, s: 13, a: 0.24, c: '#a8e2ff' },
        { x: 265, y: 915, s: 10, a: 0.18, c: '#c0b0ff' },
        { x: 760, y: 932, s: 11, a: 0.20, c: '#9ec8ff' },
        { x: 192, y: 106, s: 14, a: 0.25, c: '#e0c0ff' },
        { x: 818, y: 122, s: 12, a: 0.23, c: '#c0e2ff' },
        { x: 488, y:  52, s:  9, a: 0.17, c: '#d2c0ff' },
        { x: 488, y: 972, s:  8, a: 0.15, c: '#b2c8ff' },
    ];

    sps.forEach(({ x, y, s, a, c }) => {
        ctx.strokeStyle = c; ctx.lineWidth = 1.9;

        // Main cross
        [[0, s, 0, -s], [s, 0, -s, 0]].forEach(([x1, y1, x2, y2]) => {
            ctx.globalAlpha = a;
            ctx.beginPath(); ctx.moveTo(x + x1, y + y1); ctx.lineTo(x + x2, y + y2); ctx.stroke();
        });

        // Diagonal (shorter)
        const ds = s * 0.54;
        [[-ds, -ds, ds, ds], [ds, -ds, -ds, ds]].forEach(([x1, y1, x2, y2]) => {
            ctx.globalAlpha = a * 0.62;
            ctx.beginPath(); ctx.moveTo(x + x1, y + y1); ctx.lineTo(x + x2, y + y2); ctx.stroke();
        });

        // Center dot
        ctx.globalAlpha = Math.min(a * 1.2, 0.45);
        ctx.fillStyle = c;
        ctx.beginPath(); ctx.arc(x, y, 2.3, 0, Math.PI * 2); ctx.fill();
    });
    ctx.restore();
}

// ── Render & download ────────────────────────────────────────────────────────
function renderPreviews() {
    ['512', '192', '48'].forEach(sz => {
        const pv = document.getElementById('prev' + sz);
        const pc = pv.getContext('2d');
        pc.drawImage(src, 0, 0, +sz, +sz);
    });
}

function dl(size) {
    const off = document.createElement('canvas');
    off.width = off.height = size;
    off.getContext('2d').drawImage(src, 0, 0, size, size);
    const a = document.createElement('a');
    a.download = `jubpai-icon-${size}.png`;
    a.href = off.toDataURL('image/png');
    a.click();
}

function dlAll() {
    [1024, 512, 192, 48].forEach((s, i) => setTimeout(() => dl(s), i * 360));
}

// Wait for Cinzel font then draw
document.fonts.ready.then(() => {
    drawIcon();
    renderPreviews();
});
</script>
</body>
</html>
